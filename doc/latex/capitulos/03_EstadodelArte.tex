\chapter{Estado del arte}
	\begin{text}
		En esta sección se va a comentar el estado actual de tecnologías existentes que ofrezcan servicios similares a los de este proyecto. También para entender el problema que soluciona, se hace una pequeña reseña histórica de la evolución del tratamiento de la infraestructura en las empresas. Se incorpora un análisis del estado actual del mercado laboral para perfiles DevOps. Seguidamente es necesario hacer una comparación entre los principales proveedores cloud para resaltar el ahorro económico que supone aplicar este proyecto en lugar de otras alternativas cloud. Y por último se hace un análisis de las tecnologías existentes que pueden resolver el problema de diseño del proyecto.
	\end{text}

	\subsection{Introducción}
	\begin{text}
		Allá por 2007, en la Agile Conference de Toronto, Andrew Shafer (fundador de Puppet) da una charla sobre aplicar la metodología Agile a la infraestructura. Su único oyente Patrick Debois interesado por el tema, mantiene una larga conversación y deciden fundar una lista de correo: Agile System Administration. Este momento ha sido crucial para la filosofía DevOps ya que es en esta lista donde empiezan a germinar algunos conceptos conocidos hoy día como integración continua, entrega continua, infraestructura como código, etc.\\
		Es en 2009 cuando se produce el famoso congreso  'O'reilly Velocity Conference' donde se realiza una charla llamada '10 Deploys per day'. En esta charla se empieza a plantear seriamente la fusión de los departamentos de Desarrollo y Operaciones. A raíz de esta charla nacen los llamados DevOpsdays, desarrolladores y equipo de operaciones empiezan a trabajar conjuntamente dando ideas de como poder fusionar ambos departamentos. Los DevOpsdays, rápidamente se extienden por todo el mundo popularizándose el término DevOps como fusión de Desarrollo y Operaciones. \\

		Tradicionalmente, en el mundo IT han existido dos departamentos claramente diferenciados entre sí, Desarrolladores y Operaciones. Éstos hacen referencia a dos tipos de informático. Por un lado el desarrollador de aplicaciones, que se encarga de escribir código para cumplir unos requisitos funcionales y darle forma al producto. Este primer grupo se caracteriza por únicamente preocuparse de que la aplicación funcione correctamente en su entorno de desarrollo y que cumpla las funcionalidades descritas por el cliente. Por otro lado nos encontramos, el perfil de operaciones o sistemas o, como lo llaman algunos, 'sysadmin'. Éstos no se encargan de desarrollar aplicaciones, se encargan de realizar todas las operaciones que hay alrededor de una aplicación a nivel de sistemas, a la hora de lanzarla en un entorno de producción. Un sysadmin se encargará de toda la parte de pruebas y despliegue así como del mantenimiento de los servidores una vez desplegada la aplicación. \\
		
		Alguno ya sabrá y se habrá dado cuenta de que esta diferenciación y separación de un trabajo en dos bandos diferenciados va a causar problemas a largo plazo y no se equivoca. De hecho, si preguntas a cualquiera que haya trabajado con esta filosofía de trabajo te explicará rápidamente los problemas. Al tener los equipos separados, el desarrollador únicamente se preocupa de que su aplicación funcione en su entorno de desarrollo, lavándose las manos y dejando toda la responsabilidad en manos del equipo de sistemas. Del mismo modo, el equipo de sistemas ante cualquier fallo en la aplicación, echarán las culpas al equipo de desarrollo, ya que es su trabajo que la aplicación funcione correctamente y así sucesivamente... Son habituales los comentarios del tipo: 'Si a mí en local me funciona...' O ante cualquier fallo en producción: 'La aplicación funciona correctamente, seguro que son los sistemas...'. Como era de suponer, este enfoque no iba a durar mucho tiempo ya que los inconvenientes de esta forma de trabajar (sobretodo en equipos grandes) son insostenibles. Desafortunadamente hoy en día sigue habiendo empresas con esta filosofía de trabajo, sobretodo empresas con una larga trayectoria que se niegan a cambiar algo que 'ya funciona'. Este trabajo pretende justamente facilitar la adopción de técnicas DevOps a una pequeña empresa, cambiando el enfoque y la forma de trabajar de los departamentos de desarrollo y sistemas.
	\end{text}
	
	\subsubsection{Mercado actual}
		\begin{text}
			Es una realidad que cada día más las empresas optan por soluciones Cloud y es bastante sencillo para un programador medio crear cauces de desarrollo y despliegue para sus aplicaciones en éstos proveedores Cloud y convertirse en todo un auténtico DevOps. Se ha hablado mucho de la muerte de la figura del Administrador de Sistemas con el auge de este tipo de tecnologías, sin embargo, siempre es buena idea tener un perfil de Sistemas en los equipos DevOps ya que aportan una visión distinta y su experiencia configurando servidores, se convierte en un gran capital para un equipo DevOps. \\ 
			Sin embargo, no todas las empresas pueden permitirse los costes de este tipo de proveedores Cloud, que si bien son muy cómodos y es una muy buena solución para la infraestructura, son bastante costosos de mantener. \\
			Uno de los objetivos de este proyecto es aportar una solución integral tanto para la infraestructura donde se van a alojar los proyectos software, como la infraestructura que aloja dicha infraestructura, dando una solución directa a empresas con bajo presupuesto que no pueden permitirse soluciones Cloud. \\
		\end{text}
	
	\subsection{Proveedores Cloud}
		\begin{text}
			A continuación se va a hacer un análisis de los principales proveedores Cloud, ya que no se ha encontrado nada similar a lo que pretende este proyecto. Sin embargo los proveedores Cloud sí ofrecen dichas soluciones, contratando sus servicios. \\
			En estudio vamos a comparar los servicios Cloud y su coste con los servicios contratados para este proyecto (Servidores Bare metal) \\
		\end{text}
	
		\subsubsection{Servidores Bare Metal}
			\label{servidores_bare_metal}

			\begin{text}
				Se han contratado tres servidores en el proveedor Hetzner. Éstos son tres servidores físicos que cuentan con las siguientes características hardware:
				
				\begin{itemize}
					\item \textbf{tfg.intelligenia.com}: El servidor cuenta con las siguientes características hardware:
					
					\begin{itemize}
						\item \textbf{CPU}: 8 cores.
						\item \textbf{RAM}: 64GB 
						\item \textbf{Almacenamiento}: 2 NvMe 500GB Raid 1.
						\item \textbf{Red}: 1000Mb/s
						\item \textbf{Tráfico}: Ilimitado
						\item \textbf{Coste mes}: 38,6555 \euro
						\item \textbf{Coste anual}: 502,521 \euro
					\end{itemize}
				
					\item \textbf{tfg2.intelligenia.com}: El servidor cuenta con las siguientes características hardware:
					
					\begin{itemize}
						\item \textbf{CPU}: 8 cores.
						\item \textbf{RAM}: 16GB 
						\item \textbf{Almacenamiento}: 2 SSD 2TB Raid 1.
						\item \textbf{Red}: 1000Mb/s
						\item \textbf{Tráfico}: Ilimitado
						\item \textbf{Coste mes}: 22.6891 \euro
						\item \textbf{Coste anual}: 272,9692 \euro
					\end{itemize}

					\item \textbf{tfg3.intelligenia.com}: El servidor cuenta con las siguientes características hardware:

					\begin{itemize}
						\item \textbf{CPU}: 8 cores.
						\item \textbf{RAM}: 16GB 
						\item \textbf{Almacenamiento}: 2 SSD 2TB Raid 1.
						\item \textbf{Red}: 1000Mb/s
						\item \textbf{Tráfico}: Ilimitado
						\item \textbf{Coste mes}: 22.6891 \euro
						\item \textbf{Coste anual}: 272,9692 \euro 
					\end{itemize}
				\end{itemize}
			
			Sumando ambos costes, tendríamos un coste anual de infraestructura de \textbf{1047,75} euros. Destacar que este sería el coste únicamente de la infraestructura donde se va alojar todo el proyecto. Más adelante se detallará el coste en recursos humanos que ha supuesto configurar estos servidores para que ofrezcan servicios parecidos a los que ofrecen los grandes proveedores de Cloud.
			
			\end{text}
		
		\subsubsection{AWS}
			\begin{text}
				Amazon Web Services es una de las plataformas de computación en la nube más usadas en el mundo. 
				AWS ofrece una gran cantidad de servicios, recursos de cómputo en la nube, almacenamiento, bases de datos, herramientas de administración, seguridad, dispositivos móviles... \\
				Actualmente Amazon ofrece múltiples soluciones DevOps para empresas, sin embargo no todas las compañías se pueden permitir los costes, que aún son elevados. AWS ofrece:
				
				\clearpage
				\begin{itemize}
					\item IaC
					\item AWS OpWorks
					\item AWS CodeDeploy	
					\item AWS CodePipeline
					\item AWS CodeCommit
					\item AWS Elastic Beanstalk
					\item Security
				\end{itemize}
			
			Pese a ofrecer todos estos servicios, únicamente hemos decidido contratar máquinas virtuales con las siguientes características:
			
			\begin{itemize}
				\item \textbf{CPU}: 2 cores.
				\item \textbf{RAM}: 4GB de RAM.
				\item \textbf{Almacenamiento}: 100GB SSD.
			\end{itemize}
			
			Tras utilizar la calculadora de precios de Amazon \cite{amazoncalculadora:online} y hacer un cálculo aproximado de las máquinas virtuales que vamos a necesitar hemos obtenido el presupuesto de: \textbf{489} \euro \space  mensuales, lo que hace un total de \textbf{5868} \euro \space anuales
				
			\end{text}
		
		\subsubsection{Azure}
			\begin{text}
				Azure es la gran competidora de AWS, ofreciendo múltiples servicios en la nube. También disponen de servicios DevOps \cite{AzureDev63:online} para empresas, una solución integral y muy completa. Sin embargo deberíamos contratar el hosting para las aplicaciones a parte, ya que este servicio únicamente es para ejecutar cauces de CI/CD. Una vez más la única limitación es el poder adquisitivo de una empresa, que en caso de pequeñas compañías no lo pueden afrontar. Azure DevOps ofrece:
				\begin{itemize}
					\item Azure Boards
					\item Azure Pipelines
					\item Azure Repos
					\item Azure Atifacts (CI/CD)
					\item Azure test plans
				\end{itemize}
			
			Pese a ofrecer todos estos servicios, únicamente hemos decidido contratar máquinas virtuales con las siguientes características:
			
			\begin{itemize}
				\item \textbf{CPU}: 2 cores.
				\item \textbf{RAM}: 4GB de RAM.
				\item \textbf{Almacenamiento}: 100GB SSD.
			\end{itemize}
		
				Utilizando la calculadora de precios de Azure \cite{azurecalculadora:online} y haciendo una estimación de los recursos necesarios para el proyecto, obtenemos un presupuesto anual de \textbf{7780,96} \space \euro.
			\end{text}
	
		
		\subsubsection{Google Cloud}
			\begin{text}
				Al igual que las dos anteriores, Google Cloud ofrece servicios DevOps para empresas a precios similares \cite{GoogleCloud:online}. De igual manera el servicio de hosting para las aplicaciones va a parte y ofrece servicios como:
				\begin{itemize}
					\item Control de versiones
					\item CI
					\item Automatización de implementación
					\item Desarrollo basado en troncales
					\item Automatización de pruebas
					\item Arquitectura
					\item Seguridad
				\end{itemize}
			
			Pese a ofrecer todos estos servicios, únicamente hemos decidido contratar máquinas virtuales con las siguientes características:
			
			\begin{itemize}
				\item \textbf{CPU}: 2 cores.
				\item \textbf{RAM}: 4GB de RAM.
				\item \textbf{Almacenamiento}: 100GB SSD.
			\end{itemize}
			
			Utilizando la calculadora de precios que ofrece Google Cloud \cite{googlecloudcalculadora:online} y haciendo una estimación de los recuross necesarios , obtenemos un presupuesto anual de \textbf{7480} \euro.
			\end{text}
		
		\subsubsection{Comparación precios}
			\begin{text}
				Tras un análisis de la infraestructura necesaria para este proyecto y la correspondiente investigación en los principales proveedores cloud, ha dado como resultado la siguiente relación de precios (coste anual).
				\begin{itemize}
					\item \textbf{Google Cloud}: 7.480 \euro.
					\item \textbf{Azure}: 7.780,96 \euro.
					\item \textbf{AWS}: 5.868 \euro.
					\item \textbf{Hetzner + Proxmox}: 1.047,75 \euro.
				\end{itemize}	
			Como se puede observar, la solución propuesta por este proyecto supone un ahorro en costes sustancial. Cabe destacar que los precios anteriores son únicamente de infraestructura (máquinas linux) sin configurar, a ese precio habrá que añadirle el coste de diseñar y desplegar el proyecto.
			\end{text}
		
	\subsection{Tecnologías elegidas}
	\label{tecnologias_elegidas}
		\begin{text}
			Las tecnologías que se van a utilizar en la infraestructura y los servicios de el proyecto están bien definidas y son una restricción impuesta por la empresa (véase la sección \nameref{restricciones}), sin embargo para lograr el objetivo de este proyecto, hace falta elegir la herramienta de automatización. A continuación se va a hacer un análisis de las principales herramientas disponibles, pros y contras de cada una y el por qué se ha elegido la tecnología utilizada. \cite{comparadorAnsibleChefPuppet:online}
		\end{text}
	\subsubsection{Puppet}
		\begin{text}
			Puppet es una herramienta de software libre de gestión de configuración de software. Es comúnmente utilizado por los administradores de sistemas para configurar múltiples servidores y para automatizar las tareas de mantenimiento. Puppet se adapta perfectamente a las necesidades de este proyecto. Sin embargo, la complejidad del lenguaje ruby junto con la necesidad de crear una infraestructura maestro - esclavo con los distintos nodos hace que se haya desechado esta opción. \cite{puppet:online}
		\end{text}
		\clearpage
	\subsubsection{Chef}
		\begin{text}
			Chef es una herramienta open source con objetivos similares a Puppet. Basado en ruby y orientado a desarrolladores con experienca en ruby. La curva de aprendizaje es menor que la de Puppet. Sin embargo, también hay que crear una infraestructura específica para usar Chef con un nodo que actuaria de servidor y los nodos esclavos que serían los servidores a configurar. \cite{chef:online}
		\end{text}
		\subsubsection{Ansible}
			\begin{text}
				Por último la elegida, Ansible. Ansible está basado en python y también es software libre. La gran ventaja de Ansible frente a Chef o Puppet es que no necesitamos generar ninguna estructura específica dentro del sistema para ejecutar tareas de Ansible. Simplemente instalar Ansible y los módulos necesarios según nuestras necesidades. También aprender Ansible es bastante asequible ya que los playbooks o ficheros de configuración Ansible son ficheros .yml. Los playbooks se ejecutan en orden secuencial lo que facilita mucho su comprensión. Es por todo esto que hemos elegido Ansible como herramienta de automatización para cumplir con los objetivos de este proyecto. \cite{ansible:online}
			\end{text}
		